name: Example Workflow

on:
  push:
    branches:
      - main
  workflow_dispatch:
  
jobs:
  getsha:
    runs-on: windows-latest
    outputs:
      GIT_SHA: ${{ steps.get_sha.outputs.sha }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Get short SHA
        id: get_sha
        run: |
          $GIT_SHORT_SHA= $("${{ github.sha }}".SubString(0, 7))
          echo "Git short sha is $GIT_SHORT_SHA"
          echo "sha=$GIT_SHORT_SHA" >> $env:GITHUB_ENV
          echo "::set-output name=sha::$sha"
                        
  test-sha:
    runs-on: windows-latest
    needs: getsha
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
        
      - name: Test SHORT_SHA
        run: |
          echo "The commit hash from the build job is ${{ needs.getsha.outputs.GIT_SHA }}"    
        
